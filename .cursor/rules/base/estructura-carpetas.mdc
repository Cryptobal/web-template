---
description: 
globs: 
alwaysApply: true
---
# Regla: estructura-carpetas.mdc

## ğŸ¯ PropÃ³sito
Establecer una estructura de carpetas clara, escalable y optimizada para maximizar la eficiencia del desarrollo, mejorar la rendimiento, facilitar la mantenibilidad del cÃ³digo y permitir el crecimiento del proyecto sin necesidad de refactorizaciones significativas. Esta estructura estÃ¡ diseÃ±ada para promover prÃ¡cticas de desarrollo bien organizadas en proyectos Next.js con integraciÃ³n de Cloudflare.

---

## ğŸ“ Estructura raÃ­z

```
/
â”œâ”€â”€ app/                  # Directorio principal Next.js App Router
â”œâ”€â”€ components/           # Componentes React reutilizables
â”œâ”€â”€ lib/                  # Funciones de utilidad y lÃ³gica compartida
â”œâ”€â”€ styles/               # Estilos globales y configuraciÃ³n de Tailwind
â”œâ”€â”€ public/               # Archivos estÃ¡ticos pÃºblicos
â”œâ”€â”€ content/              # Contenido estructurado (MDX, imÃ¡genes, etc.)
â”œâ”€â”€ types/                # Definiciones de TypeScript
â”œâ”€â”€ hooks/                # Hooks personalizados de React
â”œâ”€â”€ middleware.ts         # Middleware global de Next.js
â”œâ”€â”€ .env.local            # Variables de entorno locales (gitignore)
â”œâ”€â”€ .env.example          # Ejemplo de variables de entorno
â”œâ”€â”€ next.config.js        # ConfiguraciÃ³n de Next.js
â”œâ”€â”€ postcss.config.js     # ConfiguraciÃ³n de PostCSS
â”œâ”€â”€ tailwind.config.js    # ConfiguraciÃ³n de Tailwind CSS
â”œâ”€â”€ tsconfig.json         # ConfiguraciÃ³n de TypeScript
â””â”€â”€ package.json          # Dependencias y scripts
```

---

## ğŸ“‚ Directorio `app/`

### Estructura de enrutamiento limpia

```
app/
â”œâ”€â”€ layout.tsx            # Layout principal (RootLayout)
â”œâ”€â”€ page.tsx              # PÃ¡gina de inicio
â”œâ”€â”€ favicon.ico           # Favicon
â”œâ”€â”€ globals.css           # Estilos globales importados en layout
â”œâ”€â”€ [lang]/               # Soporte para internacionalizaciÃ³n
â”‚   â”œâ”€â”€ layout.tsx        # Layout especÃ­fico por idioma
â”‚   â””â”€â”€ [...]*            # Estructura anidada con directorios de idioma
â”œâ”€â”€ (marketing)/          # Grupo de rutas de marketing (no afecta la URL)
â”‚   â”œâ”€â”€ about/            # PÃ¡gina Acerca de
â”‚   â”œâ”€â”€ contact/          # PÃ¡gina Contacto
â”‚   â””â”€â”€ services/         # Servicios ofrecidos
â”œâ”€â”€ (content)/            # Contenido editorial/blog
â”‚   â”œâ”€â”€ blog/             # Listado de blog
â”‚   â”‚   â””â”€â”€ [slug]/       # PÃ¡gina individual de blog
â”‚   â””â”€â”€ resources/        # Recursos descargables, guÃ­as, etc.
â”œâ”€â”€ (auth)/               # AutenticaciÃ³n y cuenta de usuario
â”‚   â”œâ”€â”€ login/            # Inicio de sesiÃ³n
â”‚   â”œâ”€â”€ register/         # Registro
â”‚   â””â”€â”€ reset-password/   # Restablecimiento de contraseÃ±a
â”œâ”€â”€ (dashboard)/          # Ãrea privada/Dashboard
â”‚   â”œâ”€â”€ layout.tsx        # Layout para dashboard (protegido)
â”‚   â””â”€â”€ [...]*            # Secciones del dashboard
â”œâ”€â”€ api/                  # API Routes
â”‚   â”œâ”€â”€ webhooks/         # Webhooks (Cloudflare, CMS, etc.)
â”‚   â”œâ”€â”€ revalidate/       # Endpoints de revalidaciÃ³n
â”‚   â”œâ”€â”€ search/           # API de bÃºsqueda
â”‚   â””â”€â”€ [...]*            # Otros endpoints
â””â”€â”€ sitemap.xml/          # GeneraciÃ³n dinÃ¡mica de sitemap
    â””â”€â”€ route.ts
```

### OrganizaciÃ³n de pÃ¡ginas con grupos de rutas

Los grupos de rutas `()` permiten organizar archivos sin afectar la estructura de URL, facilitando la separaciÃ³n por secciones o propÃ³sitos.

```tsx
// app/(marketing)/about/page.tsx
// URL: /about
export default function AboutPage() {
  return <div>Acerca de nosotros</div>;
}

// app/(dashboard)/settings/page.tsx
// URL: /settings
export default function SettingsPage() {
  return <div>ConfiguraciÃ³n de cuenta</div>;
}
```

---

## ğŸ§© Directorio `components/`

### Estructura de componentes por dominio

```
components/
â”œâ”€â”€ ui/                   # Componentes bÃ¡sicos de UI (Button, Card, etc.)
â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”œâ”€â”€ Input.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ layout/               # Componentes de estructura/layout
â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ forms/                # Componentes relacionados con formularios
â”‚   â”œâ”€â”€ ContactForm.tsx
â”‚   â”œâ”€â”€ NewsletterForm.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ analytics/            # Componentes para analytics/tracking
â”‚   â”œâ”€â”€ GoogleAnalytics.tsx
â”‚   â”œâ”€â”€ FacebookPixel.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ consent/              # GestiÃ³n de consentimiento de cookies
â”‚   â”œâ”€â”€ ConsentBanner.tsx
â”‚   â”œâ”€â”€ ConsentManager.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ blog/                 # Componentes especÃ­ficos para blog
â”‚   â”œâ”€â”€ PostCard.tsx
â”‚   â”œâ”€â”€ TableOfContents.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ marketing/            # Componentes de marketing y promociÃ³n
â”‚   â”œâ”€â”€ CTASection.tsx
â”‚   â”œâ”€â”€ Testimonial.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ providers/            # Providers de Context y otros wrappers
â”‚   â”œâ”€â”€ ThemeProvider.tsx
â”‚   â”œâ”€â”€ AnalyticsProvider.tsx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ skeletons/            # Componentes de carga (loading states)
â”‚   â”œâ”€â”€ CardSkeleton.tsx
â”‚   â”œâ”€â”€ PostSkeleton.tsx
â”‚   â””â”€â”€ [...]*
â””â”€â”€ schema/               # Componentes para Schema.org/SEO
    â”œâ”€â”€ BreadcrumbSchema.tsx
    â”œâ”€â”€ ProductSchema.tsx
    â””â”€â”€ [...]*
```

### Estructura de componentes compuestos

Cada componente principal debe seguir un patrÃ³n similar:

```
ui/Button/
â”œâ”€â”€ index.ts              # Re-exporta todo - facilita imports
â”œâ”€â”€ Button.tsx            # Componente principal
â”œâ”€â”€ ButtonGroup.tsx       # Variante o componente relacionado
â””â”€â”€ button-utils.ts       # Utilidades especÃ­ficas para este componente
```

---

## ğŸ“š Directorio `lib/`

### OrganizaciÃ³n de funciones utilitarias

```
lib/
â”œâ”€â”€ api/                  # Funciones para llamadas API
â”‚   â”œâ”€â”€ client.ts         # Cliente API base
â”‚   â”œâ”€â”€ endpoints.ts      # DefiniciÃ³n de endpoints
â”‚   â””â”€â”€ [...]*            # Funciones especÃ­ficas por API
â”œâ”€â”€ cms/                  # IntegraciÃ³n con CMS headless
â”‚   â”œâ”€â”€ contentful.ts     # Cliente para Contentful
â”‚   â”œâ”€â”€ queries.ts        # Queries GraphQL/GROQ
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ analytics/            # ConfiguraciÃ³n y utilidades de analytics
â”‚   â”œâ”€â”€ gtm.ts            # ConfiguraciÃ³n Google Tag Manager
â”‚   â”œâ”€â”€ events.ts         # DefiniciÃ³n de eventos
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ auth/                 # AutenticaciÃ³n y autorizaciÃ³n
â”‚   â”œâ”€â”€ session.ts
â”‚   â”œâ”€â”€ permissions.ts
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ cloudflare/           # Funciones para Cloudflare
â”‚   â”œâ”€â”€ images.ts         # Utilidades para Cloudflare Images
â”‚   â”œâ”€â”€ workers.ts        # Helpers para Workers
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ utils/                # Utilidades generales
â”‚   â”œâ”€â”€ date.ts           # Formato y manipulaciÃ³n de fechas
â”‚   â”œâ”€â”€ string.ts         # ManipulaciÃ³n de textos
â”‚   â”œâ”€â”€ validation.ts     # Funciones de validaciÃ³n
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ seo/                  # Utilidades SEO
â”‚   â”œâ”€â”€ metadata.ts       # Helpers para metadatos
â”‚   â”œâ”€â”€ schema.ts         # Generadores de Schema.org
â”‚   â””â”€â”€ [...]*
â””â”€â”€ constants.ts          # Constantes globales de la aplicaciÃ³n
```

---

## ğŸ¨ Directorio `styles/`

### OrganizaciÃ³n eficiente de estilos

```
styles/
â”œâ”€â”€ globals.css           # Estilos globales y directivas Tailwind
â”œâ”€â”€ animations.css        # Animaciones reutilizables
â”œâ”€â”€ fonts.css             # DefiniciÃ³n y carga de fuentes
â”œâ”€â”€ themes/               # Temas personalizables
â”‚   â”œâ”€â”€ light.css
â”‚   â”œâ”€â”€ dark.css
â”‚   â””â”€â”€ [...]*
â””â”€â”€ utils/                # Utilidades CSS especÃ­ficas
    â”œâ”€â”€ grid.css
    â”œâ”€â”€ typography.css
    â””â”€â”€ [...]*
```

---

## ğŸ“ Directorio `content/`

### OrganizaciÃ³n de contenido estÃ¡tico y dinÃ¡mico

```
content/
â”œâ”€â”€ blog/                 # ArtÃ­culos de blog (MDX o JSON)
â”‚   â”œâ”€â”€ first-post.mdx
â”‚   â”œâ”€â”€ second-post.mdx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ pages/                # Contenido de pÃ¡ginas estÃ¡ticas
â”‚   â”œâ”€â”€ about.mdx
â”‚   â”œâ”€â”€ terms.mdx
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ testimonials/         # Testimonios de clientes
â”‚   â”œâ”€â”€ testimonial-1.json
â”‚   â””â”€â”€ [...]*
â”œâ”€â”€ images/               # ImÃ¡genes para contenido
â”‚   â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ team/
â”‚   â””â”€â”€ [...]*
â””â”€â”€ data/                 # Datos estructurados para la aplicaciÃ³n
    â”œâ”€â”€ navigation.json   # Estructura de navegaciÃ³n
    â”œâ”€â”€ features.json     # CaracterÃ­sticas/servicios
    â””â”€â”€ [...]*
```

---

## ğŸ“ Directorio `types/`

### OrganizaciÃ³n de tipos TypeScript

```
types/
â”œâ”€â”€ index.ts              # Exporta todos los tipos comunes
â”œâ”€â”€ api.ts                # Tipos para respuestas de API
â”œâ”€â”€ cms.ts                # Tipos para contenido del CMS
â”œâ”€â”€ auth.ts               # Tipos para autenticaciÃ³n
â”œâ”€â”€ contentful.ts         # Tipos para Contentful
â”œâ”€â”€ blog.ts               # Tipos para blog
â””â”€â”€ [...]*                # Otros tipos especÃ­ficos
```

---

## ğŸª Directorio `hooks/`

### OrganizaciÃ³n de hooks personalizados

```
hooks/
â”œâ”€â”€ useApi.ts             # Hook para llamadas API
â”œâ”€â”€ useAuth.ts            # Hook para autenticaciÃ³n
â”œâ”€â”€ useLocalStorage.ts    # Hook para localStorage
â”œâ”€â”€ useDarkMode.ts        # Hook para modo oscuro
â”œâ”€â”€ useMediaQuery.ts      # Hook para responsive design
â”œâ”€â”€ useOnScreen.ts        # Hook para detectar elementos en viewport
â””â”€â”€ [...]*                # Otros hooks especÃ­ficos
```

---

## ğŸš€ Optimizaciones estructurales para rendimiento

### 1. Estructura para Code Splitting eficiente

```tsx
// ImportaciÃ³n dinÃ¡mica de componentes pesados
import dynamic from 'next/dynamic';

// Cargar solo cuando sea necesario
const VideoPlayer = dynamic(() => import('@/components/media/VideoPlayer'), {
  loading: () => <div className="w-full aspect-video bg-neutral-100 animate-pulse" />,
  ssr: false, // No renderizar en servidor si no es necesario
});

// Componente de mapa pesado
const Map = dynamic(() => import('@/components/Map'), {
  loading: () => <div className="h-[400px] bg-neutral-100 animate-pulse" />,
  ssr: false,
});
```

### 2. Estructura para Route Handlers optimizados

```typescript
// app/api/products/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { getProducts } from '@/lib/cms/products';

export async function GET(request: NextRequest) {
  // CachÃ© para rutas API - optimiza rendimiento
  const response = NextResponse.json(await getProducts());
  
  // Cache por 10 minutos, stale-while-revalidate por 1 dÃ­a
  response.headers.set('Cache-Control', 'public, max-age=600, stale-while-revalidate=86400');
  
  return response;
}
```

### 3. Estructura para generaciÃ³n estÃ¡tica incremental (ISR)

```typescript
// app/(content)/blog/[slug]/page.tsx
import { getAllSlugs, getPostBySlug } from '@/lib/cms/blog';

// Revalidar contenido cada hora
export const revalidate = 3600;

export async function generateStaticParams() {
  const slugs = await getAllSlugs();
  
  return slugs.map(slug => ({
    slug,
  }));
}

export default async function BlogPost({ params }: { params: { slug: string } }) {
  const post = await getPostBySlug(params.slug);
  
  // Renderizar el post
}
```

---

## ğŸ“ Convenciones de nomenclatura

### 1. Archivos y carpetas

- **Componentes**: PascalCase (`Button.tsx`, `ProductCard.tsx`)
- **Hooks**: camelCase con prefijo `use` (`useAuth.ts`, `useLocalStorage.ts`)
- **Utilidades/Helpers**: camelCase (`string-utils.ts`, `date-formatter.ts`)
- **Tipos**: PascalCase (`User.ts`, `ApiResponse.ts`)
- **Constantes**: UPPER_SNAKE_CASE para valores fijos, PascalCase para enums

### 2. Estructura de imports ordenada

```typescript
// 1. Imports externos/de biblioteca
import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import clsx from 'clsx';

// 2. Imports de tipos o interfaces (separados)
import type { User, AuthResponse } from '@/types';

// 3. Imports de componentes (orden alfabÃ©tico)
import { Button } from '@/components/ui/Button';
import { Card } from '@/components/ui/Card';

// 4. Imports de hooks
import { useAuth } from '@/hooks/useAuth';

// 5. Imports de utils y otras funciones
import { formatDate } from '@/lib/utils/date';
```

---

## ğŸ› ï¸ Reglas para Cursor (OrganizaciÃ³n)

- Usar App Router con grupos de rutas para organizar sin afectar URLs
- Organizar componentes por dominio/propÃ³sito, no por tipo de componente
- Mantener un lÃ­mite de archivos por carpeta (mÃ¡ximo 10-15) y subdividir si crece mÃ¡s
- Crear Ã­ndices para exportar desde carpetas con mÃºltiples componentes
- Mantener jerarquÃ­a de 3 niveles mÃ¡ximo por carpeta para evitar anidamiento excesivo
- Implementar lazy loading para componentes pesados usando dynamic imports
- Agrupar componentes relacionados en subcarpetas con un index.ts para re-exportaciÃ³n
- Mantener rutas API organizadas por dominio y funcionalidad
- Usar convenciones de nomenclatura consistentes en todo el proyecto
- Crear tipos TypeScript separados y reutilizables para todo el sistema
